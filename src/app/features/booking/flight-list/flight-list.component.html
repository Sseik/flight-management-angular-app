<div class="container">
  <h2>–ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Ä–µ–π—Å–∞–º–∏</h2>

  <div class="actions-bar" style="display: flex; flex-wrap: wrap; gap: 15px; align-items: center; margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
    
    <div style="display: flex; gap: 5px;">
        <input type="text" [(ngModel)]="searchTerm" placeholder="–ü–æ—à—É–∫..." style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
        <button (click)="search()" style="cursor: pointer; padding: 0 10px;">üîç</button>
    </div>

    <select [(ngModel)]="selectedCity" (change)="filterByCity()" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
      <option value="">üåç –í—Å—ñ –º—ñ—Å—Ç–∞</option>
      @for (city of cities; track city) {
        <option [value]="city">{{ city }}</option>
      }
    </select>

    <div style="display: flex; align-items: center; gap: 5px; border-left: 2px solid #ddd; padding-left: 15px;">
      <label for="userSelect" style="font-weight: bold; color: #555;">–•—Ç–æ –∫—É–ø—É—î:</label>
      <select id="userSelect" [(ngModel)]="selectedUserId" style="padding: 8px; border: 2px solid #0d6efd; border-radius: 4px; font-weight: bold;">
        @for (user of users; track user.user_id) {
          <option [ngValue]="user.user_id">üë§ {{ user.username }}</option>
        }
      </select>
    </div>

    <div style="flex-grow: 1;"></div>

    <button (click)="createTestFlight()" style="background-color: #0d6efd; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer;">
      + –î–æ–¥–∞—Ç–∏ —Ä–µ–π—Å
    </button>
  </div>

  <table class="flight-table">
    <thead>
      <tr>
          <th>‚Ññ</th>
          <th>–ú–∞—Ä—à—Ä—É—Ç</th>
          <th>–ß–∞—Å</th>
          <th>–°—Ç–∞—Ç—É—Å</th> <th>–î—ñ—ó</th>
      </tr>
    </thead>
    <tbody>
      @for (flight of flights; track flight.flightId) {
        <tr>
          <td><strong>{{ flight.flightNumber }}</strong></td>
          <td>
            {{ flight.origin }} ‚ûù {{ flight.destination }}
            <br>
            <small style="color: #666;">
                ‚è± {{ flight.departureTime | date:'shortTime' }} - {{ flight.arrivalTime | date:'shortTime' }}
            </small>
          </td>
          <td>
            {{ flight.departureTime | date:'dd.MM.yyyy' }}
            <br>
            <small class="text-muted">{{ flight.departureTime | date:'HH:mm' }}</small>
          </td>
          
          <td>
            <span [ngClass]="{
              'status-scheduled': flight.status === 'Scheduled',
              'status-cancelled': flight.status === 'Cancelled',
              'status-arrived': flight.status === 'Arrived',
              'status-delayed': flight.status === 'Delayed'
            }">
              {{ flight.status }}
            </span>
          </td>

          <td>
             @if (flight.status === 'Scheduled') {
                <button (click)="bookFlight(flight.flightId)" title="–ó–∞–±—Ä–æ–Ω—é–≤–∞—Ç–∏" style="margin-right: 5px; cursor: pointer;">üé´</button>
             }

             @if (flight.status === 'Scheduled' || flight.status === 'Delayed' || flight.status === 'On Time') {
                <button (click)="cancelFlight(flight.flightId)" title="–°–∫–∞—Å—É–≤–∞—Ç–∏ (–¥–ª—è –∞—Ä—Ö—ñ–≤—É)" style="margin-right: 5px; cursor: pointer; border: none; background: none;">
                    ‚ùå
                </button>
                
                <button (click)="delayFlight(flight.flightId)" title="–ó–∞—Ç—Ä–∏–º–∞—Ç–∏" style="margin-right: 5px; cursor: pointer; color: orange; border: none; background: none;">
                    ‚è≥
                </button>
             }

             <button (click)="deleteFlight(flight.flightId)" title="–í–∏–¥–∞–ª–∏—Ç–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é" style="color: red; cursor: pointer; border: none; background: none;">üóëÔ∏è</button>
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>